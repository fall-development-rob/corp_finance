## claude-flow hive-mind swarm configuration
## Run with: npx claude-flow hive-mind init -t hierarchical-mesh && npx claude-flow swarm start --config .hive-mind/sscmfi-swarm.yaml
##
## Purpose: Build SSCMFI bond math engine into corp-finance-core Rust lib,
## create MCP server tools, CLI commands, and Claude Code skills.

name: sscmfi-bond-math-swarm
description: >
  Extract SSCMFI bond math capabilities and implement as native Rust
  calculations with 128-bit decimal precision. Create MCP tools, CLI
  commands, and Claude Code skills following existing project patterns.

topology: hierarchical-mesh
consensus: byzantine
max_agents: 6

objective: >
  Implement SSCMFI-compatible bond math in the corp-finance-core Rust library
  supporting 7 payment types (Periodic, Discount, IAM, Stepped, Multistep,
  PIK, Part-PIK), 4 day count conventions (30/360, ACT/ACT, ACT/360, ACT/365),
  callable bond yield-to-worst with multiple call schedules, PV01, YV32,
  and full cash flow analytics. Then wire up as MCP tools, CLI commands,
  and Claude Code skills.

agents:
  - id: queen-coordinator
    role: queen
    type: strategic
    objective: >
      Coordinate all worker agents. Ensure types, calculations, CLI, MCP,
      and skills are implemented consistently. Verify all tests pass.

  - id: rust-types-agent
    role: worker
    type: specialist
    objective: >
      Add SSCMFI bond math types to crates/corp-finance-core/src/fixed_income/sscmfi.rs.
      Include SecurityType, PaymentType, DayCountBasis, EomRule, CouponFrequency,
      CallRedemption, SscmfiBondInput, SscmfiBondOutput, SscmfiAnalytics,
      SscmfiCashflowEntry, and SscmfiRedemptionInfo structs.
      Follow existing patterns from bonds.rs and duration.rs.
      All monetary values use rust_decimal::Decimal (128-bit precision).

  - id: rust-calc-agent
    role: worker
    type: specialist
    objective: >
      Implement the SSCMFI calculation engine in sscmfi.rs.
      Functions: calculate_sscmfi_periodic, calculate_sscmfi_discount,
      calculate_sscmfi_iam, calculate_sscmfi_stepped, calculate_sscmfi_multistep,
      calculate_sscmfi_pik, calculate_sscmfi_partpik.
      Each must compute: price/yield, accrued interest, duration, convexity,
      PV01, YV32, cashflow schedule, and yield-to-worst for callable bonds.
      Use Newton-Raphson for yield solving. Never use powd().

  - id: cli-agent
    role: worker
    type: specialist
    objective: >
      Add SSCMFI CLI commands to crates/corp-finance-cli/src/commands/fixed_income.rs
      and register in main.rs. Commands: sscmfi-periodic, sscmfi-discount,
      sscmfi-iam, sscmfi-stepped, sscmfi-multistep, sscmfi-pik, sscmfi-partpik.
      Follow existing pattern with --input JSON file and stdin support.

  - id: mcp-agent
    role: worker
    type: specialist
    objective: >
      Add SSCMFI MCP tools to packages/mcp-server/src/tools/.
      Tools: sscmfi_bond_periodic, sscmfi_bond_discount, sscmfi_bond_iam,
      sscmfi_bond_stepped, sscmfi_bond_multistep, sscmfi_bond_pik,
      sscmfi_bond_partpik, sscmfi_bond_batch.
      Follow existing MCP tool patterns with JSON schema validation.

  - id: skills-agent
    role: worker
    type: specialist
    objective: >
      Create Claude Code skill at .claude/skills/sscmfi-bond-math-native/SKILL.md.
      Document all SSCMFI MCP tools, CLI commands, response envelope,
      tool chaining workflows, and input conventions.
      Follow the exact SKILL.md format from corp-finance-tools-core/SKILL.md.

tasks:
  - id: implement-types
    agent: rust-types-agent
    description: Add SSCMFI types to Rust core library
    priority: critical
    depends_on: []

  - id: implement-calc
    agent: rust-calc-agent
    description: Implement SSCMFI calculation engine
    priority: critical
    depends_on: [implement-types]

  - id: implement-cli
    agent: cli-agent
    description: Add SSCMFI CLI commands
    priority: high
    depends_on: [implement-types]

  - id: implement-mcp
    agent: mcp-agent
    description: Add SSCMFI MCP server tools
    priority: high
    depends_on: [implement-types]

  - id: implement-skills
    agent: skills-agent
    description: Create SSCMFI Claude Code skills
    priority: medium
    depends_on: [implement-mcp, implement-cli]
